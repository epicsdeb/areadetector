From: Michael Davidsaver <mdavidsaver@bnl.gov>
Date: Wed, 2 Nov 2011 16:19:59 -0400
Subject: [PATCH] build IOCs for aravis and dcam

---
 aravis/aravisGigEApp/src/Makefile |   25 +++++++++++++++++++++----
 dcam/firewireDCAMApp/src/Makefile |   14 +++++++++++++-
 2 files changed, 34 insertions(+), 5 deletions(-)

diff --git a/aravis/aravisGigEApp/src/Makefile b/aravis/aravisGigEApp/src/Makefile
index 45e5f30..deefa50 100644
--- a/aravis/aravisGigEApp/src/Makefile
+++ b/aravis/aravisGigEApp/src/Makefile
@@ -18,6 +18,19 @@ aravisCamera_SRCS += aravisCamera.cpp
 
 DBD += aravisCameraSupport.dbd
 
+
+PROD_IOC += aravisGigEApp
+
+DBD += aravisGigEApp.dbd
+
+aravisGigEApp_DBD += commonDriverSupport.dbd
+aravisGigEApp_DBD += aravisCameraSupport.dbd
+
+# <name>_registerRecordDeviceDriver.cpp will be created from <name>.dbd
+PROD_SRCS += aravisGigEApp_registerRecordDeviceDriver.cpp aravisCameraMain.cpp
+
+PROD_LIBS += aravisCamera
+
 # If glib is not in a standard place, tell the build system where to look
 ifneq ($(GLIBPREFIX),)
 	USR_INCLUDES += -I$(GLIBPREFIX)/include/aravis-0.2
@@ -26,12 +39,16 @@ ifneq ($(GLIBPREFIX),)
 	glib-2.0_DIR = $(GLIBPREFIX)/lib
 endif	
 
-# We need to link against aravis
-USR_INCLUDES += -I$(TOP)/include/aravis-0.2
-USR_LIBS += glib-2.0
-USR_LIBS += aravis-0.2
+PROD_LIBS += aravis-0.2 gio-2.0 gobject-2.0 gthread-2.0 glib-2.0 pcre
+LIB_LIBS += aravis-0.2 gio-2.0 gobject-2.0 gthread-2.0 glib-2.0 pcre
 
 glib-2.0_DIR=/usr/lib
 aravis-0.2_DIR=/usr/lib
+gobject-2.0_DIR=/usr/lib
+gthread-2.0_DIR=/usr/lib
+gio-2.0_DIR=/usr/lib
+pcre_DIR=/usr/lib
+
+include $(TOP)/ADApp/commonDriverMakefile
 
 include $(TOP)/configure/RULES
diff --git a/dcam/firewireDCAMApp/src/Makefile b/dcam/firewireDCAMApp/src/Makefile
index f4ab336..e639677 100644
--- a/dcam/firewireDCAMApp/src/Makefile
+++ b/dcam/firewireDCAMApp/src/Makefile
@@ -50,6 +50,18 @@ dc1394_DIR=/usr/lib
 raw1394_DIR=/usr/lib
 usb-1.0_DIR=/usr/lib
 
-#include $(AREA_DETECTOR)/ADApp/commonDriverMakefile
+PROD_IOC += firewireDCAMApp
+
+DBD += firewireDCAMApp.dbd
+
+firewireDCAMApp_DBD += commonDriverSupport.dbd
+firewireDCAMApp_DBD += firewireDCAM.dbd
+
+# <name>_registerRecordDeviceDriver.cpp will be created from <name>.dbd
+firewireDCAMApp_SRCS += firewireDCAMApp_registerRecordDeviceDriver.cpp firewireDCAMMain.cpp
+
+firewireDCAMApp_LIBS += firewireDCAM dc1394 raw1394 usb-1.0
+
+include $(TOP)/ADApp/commonDriverMakefile
 
 include $(TOP)/configure/RULES
-- 
